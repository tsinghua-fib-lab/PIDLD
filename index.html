<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>PIDLD Website</title>
  <style>
        /* Responsive base + box sizing */
        *, *::before, *::after { box-sizing: border-box; }

        /* Basic styles */
        body {
            font-family: Arial, sans-serif;
            line-height: 1.6;
            margin: 0 auto;
            max-width: 1100px;
            padding: 20px;
            background-color: rgb(240,240,240);
            color: black;
        }
        h1 {
            font-size: 2.2rem;
            color: rgb(32,32,128);
            text-align: center;
            margin-bottom: 16px;
        }
        h2 {
            font-size: 1.4rem;
            color: rgb(64,64,96);
            margin-top: 28px;
            margin-bottom: 18px;
            border-bottom: 2px solid rgb(64,128,216);
            padding-bottom: 6px;
        }
        h3 {
            font-size: 1.1rem;
            color: rgb(64,64,96);
            margin-top: 20px;
            margin-bottom: 14px;
        }
        p {
            font-size: 1rem;
            margin: 8px 0;
        }

        /* Grid / layout */
        .grid-two-column {
            width: 100%;
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            grid-row-gap: 12px;
            grid-column-gap: 12px;
            margin: auto;
            align-items: start;
        }
        .grid-one-column {
            width: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 12px;
        }
        .grid-one-row {
            width: 100%;
            display: flex;
            flex-direction: row;
            align-items: center;
            gap: 12px;
        }

        /* Links / buttons */
        a {
            color: rgb(64, 128, 216);
            text-decoration: none;
        }
        a:hover { color: rgb(216, 128, 216); }
        .button-link {
            background-color: transparent;
            text-decoration: none;
            border: 1px solid rgba(0,0,0,0.8);
            padding: 8px 14px;
            border-radius: 18px;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            font-size: 0.95rem;
        }
        .button-link:hover { background-color: rgba(0,0,0,0.03); }

        /* Images */
        img {
          max-width: 100%;
          height: auto;
          display: block;
          margin: 0 auto;
        }
        .icon {
            height: 20px;
            width: 20px;
            margin-right: 10px;
            object-fit: contain;
            display: inline-block;
        }
        .figure-container {
            background: rgb(255,255,255);
            border: 1px solid rgba(0,0,0,0.8);
            margin: 10px 0;
            padding: 12px;
            border-radius: 10px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.08);
            text-align: center;
            width: 100%;
        }
        .figure-text {
            font-size: 0.98rem;
            color: black;
            margin-top: 10px;
            text-align: center;
        }

        /* Tables: responsive wrapper + basic style */
        .table-wrap {
            width: 100%;
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
            margin-top: 16px;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 8px;
            min-width: 640px; /* allow horizontal scroll on small screens */
        }
        table th, table td {
            border: 1px solid rgba(0,0,0,0.8);
            text-align: center;
            padding: 8px;
            vertical-align: middle;
            font-size: 0.95rem;
        }

        /* Algorithm block */
        .algorithm {
            margin-top: 1em;
            border: 2px solid rgba(0,0,0,0.8);
            padding: 1em;
            border-radius: 8px;
            background: #fff;
        }
        .line-numbered {
            display: flex;
            margin-bottom: 0.5em;
            gap: 8px;
            flex-wrap: nowrap;
        }
        .line-number {
            width: 3.2em;
            text-align: right;
            padding-right: 0.8em;
            color: gray;
            flex: 0 0 auto;
            font-family: monospace;
            font-size: 0.95rem;
        }
        .line-content {
            flex: 1 1 auto;
            min-width: 0; /* allow truncation/wrap inside flex */
            font-size: 0.98rem;
        }
        .indent-1 { margin-left: 1.6em; }
        .indent-2 { margin-left: 3.2em; }
        .indent-3 { margin-left: 4.8em; }
        .math { margin: 0.5em 0; }

        /* Citation */
        .citation-box {
            background: #f6f8fa;
            border: 1px solid #d0d7de;
            border-radius: 6px;
            padding: 14px;
            font-family: 'SFMono-Regular', 'Monaco', 'Consolas', monospace;
            font-size: 0.92rem;
            line-height: 1.45;
            color: #24292f;
            overflow-x: auto;
            white-space: pre-wrap;
        }

        /* Small screen adjustments */
        @media (max-width: 900px) {
            body { padding: 16px; max-width: 760px; }
            h1 { font-size: 1.8rem; }
            h2 { font-size: 1.2rem; }
            .grid-two-column { grid-template-columns: 1fr; }
            .grid-one-row { flex-direction: column; align-items: stretch; }
            .figure-text { text-align: left; }
            .line-numbered { flex-wrap: wrap; }
            .line-number { width: 2.6em; padding-right: 0.6em; }
            table { min-width: 600px; }
        }

        @media (max-width: 480px) {
            body { padding: 12px; max-width: 420px; }
            h1 { font-size: 1.5rem; }
            .button-link { padding: 6px 10px; font-size: 0.9rem; }
            .line-number { display: inline-block; width: 2.2em; font-size: 0.85rem; }
            table th, table td { padding: 6px; font-size: 0.88rem; }
            .figure-container { padding: 10px; border-radius: 8px; }
        }
  </style>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
  <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [['$', '$'], ['\\(', '\\)']],
            displayMath: [['$$', '$$'], ['\\[', '\\]']],
            processEscapes: true
        }
    });
  </script>
    
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.2/css/academicons.min.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" integrity="sha512-..." crossorigin="anonymous" referrerpolicy="no-referrer" />
</head>

<body>


<h1>PID-controlled Langevin Dynamics for Faster Sampling of Generative Models</h1>


<div style="text-align:center; margin-top:12px;">
  <span style="display:inline-block; margin:0 0 8px 0; font-size:1.5em; font-weight:600;">üíê Paper accepted at <span style="color:rgb(216,32,32);">NeurIPS 2025</span></span>
  <p style="margin:8px 0 6px 0; font-size:1rem;">
    Hongyi Chen<sup>1,3*</sup>,
    Jianhai Shu<sup>2*</sup>,
    Jingtao Ding<sup>2‚Ä†</sup>,
    Yong Li<sup>2</sup>,
    Xiao-Ping Zhang<sup>1‚Ä†</sup>
  </p>
  <p style="margin:6px 0 0 0; font-size:0.90rem; color: rgb(32,32,32);">
    <sup>1</sup> Shenzhen Key Laboratory of Ubiquitous Data Enabling Laboratory, Shenzhen International Graduate School, Tsinghua University,<br>
    <sup>2</sup> Department of Electronic Engineering, Tsinghua University,<br>
    <sup>3</sup> Pengcheng Laboratory.
  </p>
</div>

<div style="text-align: center; margin: 20px 0; display: flex; justify-content: center; gap: 16px; flex-wrap: wrap;">
  <a href="https://openreview.net/forum?id=y9LHDCKeeN" class="button-link"><img src="https://arxiv.org/favicon.ico" alt="arXiv" class="icon">Paper</a>
  <a href="https://neurips.cc/virtual/2025/loc/san-diego/poster/115179" class="button-link"><img src="https://neurips.cc/static/core/img/neurips-logo-new.svg" alt="NeurIPS" class="icon">NeurIPS</a>
  <a href="https://github.com/tsinghua-fib-lab/PIDLD" class="button-link"><i class="fab fa-github" style="margin-right: 10px;"></i>Code</a>
</div>

<div class="figure-container">
  <img src="fig/intro_4.jpg">
  <div class="figure-text">PID-controlled systems <strong>eliminate errors at steady-state</strong> through the integral term while <strong>dampening overshoot</strong> via the derivative term.</div>
</div>


<h2>üîç Highlights</h2>

<ul>
  <li><strong>Control-theoretic insight:</strong> Reinterprets Langevin dynamics as a <strong>feedback control system</strong>, where energy gradients act as feedback signals.</li>
  <li><strong>PID-enhanced sampling:</strong> Integrates <em>Proportional</em>, <em>Integral</em>, and <em>Derivative</em> control terms into Langevin updates:
    <ul>
      <li><strong>P-term:</strong> basic gradient guidance;</li>
      <li><strong>I-term:</strong> accumulates historical gradients for momentum-like acceleration;</li>
      <li><strong>D-term:</strong> anticipates gradient trends for adaptive stabilization.</li>
    </ul>
  </li>
  <li><strong>Plug-and-play compatibility:</strong>
    <ul>
      <li>Requires no retraining or prior information;
      <li>Integrates with any Langevin-based sampler directly (EBM, SGM, diffusion, etc.).
    </ul>
  </li>
  <li><strong>Significant speedup:</strong>
    <ul>
      <li>Achieves up to <strong>10√ó faster sampling</strong> while maintaining or improving generation quality across image and reasoning tasks.</li>
    </ul>
  </li>
</ul>


<h2>‚öôÔ∏è Algorithm Workflow</h2>

<p>The PID-controlled Langevin dynamics update is given by:
  <div class="math">\[
    x_{t+1}=x_t+\epsilon\Big(k_p\nabla_{x}U_\theta(x_t)+\frac{k_i}{t}\sum_{s=0}^{t}\nabla_{x}U_\theta(x_s)+k_d(\nabla_{x}U_\theta(x_t)-\nabla_xU_\theta(x_{t-1}))\Big)+\sqrt{2\epsilon}\,\xi_t,
  \]</div>
  where $k_p,k_i,k_d$ are the coefficients of the proportional, integral, and derivative gains, $U_{\theta}(\cdot)$ is the energy function, and $\xi_t\sim\mathcal{N}(\mathbf{0},\mathbf{I})$.
</p>

<div class="algorithm" id="alg-PIDLD">
  <div class="caption"><strong>PIDLD Algorithm Flowchart</strong></div>
  <div class="line-numbered"><span class="line-number">1</span><span class="line-content"><b>Require:</b> Score function \( \nabla_x U_\theta(x)=\nabla_x\log p_\theta(x)=\nabla_x(-f_\theta(x)) \); number of steps \(T\); step size \(\epsilon\); control parameters \(k_p,k_i,k_d\); decay rate \(\gamma &lt; 1\); initial point \(x_0\).</span></div>
  <div class="line-numbered"><span class="line-number">2</span><span class="line-content">Initialize integral term \(I_0=0\).</span></div>
  <div class="line-numbered"><span class="line-number">3</span><span class="line-content">Compute initial score \(s_0=\nabla_x U_\theta(x_0)\).</span></div>
  <div class="line-numbered"><span class="line-number">4</span><span class="line-content">For \(t=0\) to \(T-1\) do</span></div>
  <div class="line-numbered"><span class="line-number">5</span><span class="line-content indent-1">\(s_t=\nabla_x U_\theta(x_t)\).</span></div>
  <div class="line-numbered"><span class="line-number">6</span><span class="line-content indent-1">\(P_t = s_t\)  <span style="color:#666;">(Proportional term)</span></span></div>
  <div class="line-numbered"><span class="line-number">7</span><span class="line-content indent-1">\(I_t = \frac{1}{t+1}\big(I_{t-1}\cdot t + s_t\big)\)  <span style="color:#666;">(Integral term)</span></span></div>
  <div class="line-numbered"><span class="line-number">8</span><span class="line-content indent-1">\(D_t = s_t - s_{t-1}\)  <span style="color:#666;">(Derivative term)</span></span></div>
  <div class="line-numbered"><span class="line-number">9</span><span class="line-content indent-1">Compute control signal: \(u_t = k_p P_t + k_i I_t + k_d D_t\).</span></div>
  <div class="line-numbered"><span class="line-number">10</span><span class="line-content indent-1">Update state:
    <div class="math">\[
      x_{t+1} = x_t + \epsilon \cdot u_t + \sqrt{2\epsilon}\,\xi_t,\quad \xi_t \sim \mathcal{N}(0,I)
    \]</div>
  </span></div>
  <div class="line-numbered"><span class="line-number">11</span><span class="line-content indent-1">Decay integral gain: \(k_i = k_i \cdot \gamma\).</span></div>
  <div class="line-numbered"><span class="line-number">12</span><span class="line-content">End for</span></div>
  <div class="line-numbered"><span class="line-number">13</span><span class="line-content"><b>Return:</b> \(\hat{x} = x_T\).</span></div>
</div>


<h2>üìä Experiments</h2>

<p>In the experiments, we evaluated our method against standard Langevin sampling on mainstream generative models (SGM, EBM). We first used <strong>toy experiments</strong> on 2-d point datasets to validate the effectiveness of integral and derivative terms, and then used benchmark datasets in classical <strong>image generation</strong> tasks and <strong>reasoning</strong> tasks to further demonstrate the superiority of our method.</p>


<h3>Toy Experiments</h3>

<p>In the toy experiments, we sample points from a 2-d Gaussian mixture distribution using PID-controlled Langevin dynamics with different control parameters, and compare the sampling speed and quality.</p>

<div class="grid-two-column">
<div class="figure-container" style="float: left;">
  <img src="fig/kl_ID.jpg">
  <div class="figure-text">
    Adding $I$ term, $D$ term, or both $I$ and $D$ terms, would significantly accelerate sampling process and produce lower KL divergence.
  </div>
</div>
<div class="figure-container" style="float: right;">
  <img src="fig/kl_D.jpg">
  <div class="figure-text">
    Increasing derivative term coefficient $k_d$ produces lower KL divergence.
  </div>
</div>
<div class="figure-container" style="float: left;">
  <img src="fig/kl_I.jpg">
  <div class="figure-text">
    Increasing integral term coefficient $k_i$ produces lower KL divergence, but excessive $k_i$ may lead to rebounding phenomenon.
  </div>
</div>
<div class="figure-container" style="float: right;">
  <img src="fig/kl_I_decay.jpg">
  <div class="figure-text">Decaying integral term coefficient $k_i$ ensures smoother transition from early exploration to later convergence, alleviating the rebounding phenomenon.</div>
</div>
</div>

<div class="grid-one-column">
<div class="figure-container">
  <img src="fig/bias_ki_kd.jpg">
  <div class="figure-text">Effect of $k_i$ and $k_d$ on bias. Adding $I$ term (left) excels in mitigating bias.</div>
</div>
<div class="figure-container">
  <img src="fig/oscillation_ki_kd.jpg">
  <div class="figure-text">Effect of $k_i$ and $k_d$ on oscillation. Adding $D$ term (right) excels in reducing oscillation.</div>
</div>
</div>


<h3>Computer Vision Tasks</h3>

<p>For the computer vision task, we use score-based generative model (NCSNv2) and energy-based model (IGEBM) to sample images from CIFAR10 and CelebA datasets. Our proposed PIDLD method outperforms all the baselines across different settings.</p>

<div class="grid-one-column">
<div class="figure-container">
  <img src="fig/cifar10_comparison.jpg">
  <div class="figure-text">CIFAR10 samples with 25 sampling steps using score-based generative model.</div>
</div>
<div class="figure-container">
  <img src="fig/celeba_comparison.jpg">
  <div class="figure-text">CelebA samples with 25 sampling steps using score-based generative model.</div>
</div>
</div>

<table width="100%">
  <caption><strong>FID comparison for SGM and EBM models across different NFEs on CIFAR10 and CelebA dataset.</strong></caption>
  <thead>
    <tr>
      <th rowspan="2">Dataset</th>
      <th></th>
      <th colspan="5" style="text-align: center;">SGM</th>
      <th colspan="4" style="text-align: center;">EBM</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td rowspan="3">CIFAR10</td>
      <td>NFEs</td>
      <td>25√ó1</td>
      <td>100√ó1</td>
      <td>232√ó1</td>
      <td>232√ó3</td>
      <td>232√ó5</td>
      <td>10</td>
      <td>20</td>
      <td>30</td>
      <td>40</td>
    </tr>
    <tr>
      <td>Vanilla</td>
      <td>46.8</td>
      <td>17.2</td>
      <td>16.0</td>
      <td>12.8</td>
      <td>12.5</td>
      <td>135.8</td>
      <td>58.1</td>
      <td>40.3</td>
      <td>35.3</td>
    </tr>
    <tr>
      <td>Ours</td>
      <td><strong>18.3</strong></td>
      <td><strong>12.1</strong></td>
      <td><strong>11.7</strong></td>
      <td><strong>11.6</strong></td>
      <td><strong>11.4</strong></td>
      <td><strong>99.0</strong></td>
      <td><strong>46.1</strong></td>
      <td><strong>32.8</strong></td>
      <td><strong>33.2</strong></td>
    </tr>
    <tr>
      <td rowspan="3">CelebA</td>
      <td>NFEs</td>
      <td>50√ó1</td>
      <td>250√ó1</td>
      <td>500√ó1</td>
      <td>500√ó3</td>
      <td>500√ó5</td>
      <td>15</td>
      <td>20</td>
      <td>25</td>
      <td>30</td>
    </tr>
    <tr>
      <td>Vanilla</td>
      <td>25.0</td>
      <td>13.6</td>
      <td>14.0</td>
      <td>11.3</td>
      <td>9.5</td>
      <td>109.1</td>
      <td>63.5</td>
      <td>41.3</td>
      <td>35.4</td>
    </tr>
    <tr>
      <td>Ours</td>
      <td><strong>8.0</strong></td>
      <td><strong>5.7</strong></td>
      <td><strong>5.9</strong></td>
      <td><strong>5.9</strong></td>
      <td><strong>5.6</strong></td>
      <td><strong>58.0</strong></td>
      <td><strong>38.9</strong></td>
      <td><strong>32.2</strong></td>
      <td><strong>30.0</strong></td>
    </tr>
  </tbody>
</table>

<div class="figure-container">
  <div class="grid-one-row">
    <div><img src="fig/ablation_cv.jpg" width="50%"></div>
    <div class="figure-text" style="text-align: left;">Ablation study of PIDLD under image sampling tasks. P+I+D denotes the complete model, while P+I, P+D, and P represent models with the derivative term, integral term, or both terms removed, respectively. Figures on the bar indicate performance improvements of each ablation compared to P.</div>
  </div>
</div>


<h3>Reasoning Tasks</h3>

<p>For the reasoning task, we use energy-based model (IRED) to sample solutions for Sudoku and connectivity tasks. Our proposed PIDLD method outperforms all the baselines across different settings.</p>

<table width="100%">
  <caption><strong>Accuracy comparison for baseline and our models across Sudoku and Connectivity tasks under different NFEs.</strong></caption>
  <thead>
    <tr>
      <th>Task</th>
      <th colspan="7" style="text-align: center;">EBM Accuracy (%)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td rowspan="4">Sudoku</td>
      <td>NFEs</td>
      <td>5</td>
      <td>10</td>
      <td>15</td>
      <td>30</td>
      <td>40</td>
      <td>80</td>
    </tr>
    <tr>
      <td>Vanilla</td>
      <td>45.99</td>
      <td>51.00</td>
      <td>50.93</td>
      <td>50.77</td>
      <td>53.63</td>
      <td>55.02</td>
    </tr>
    <tr>
      <td>MILD</td>
      <td>49.75</td>
      <td>54.82</td>
      <td>53.55</td>
      <td>55.25</td>
      <td>56.56</td>
      <td>56.64</td>
    </tr>
    <tr>
      <td>Ours</td>
      <td><strong>50.54</strong></td>
      <td><strong>55.48</strong></td>
      <td><strong>55.55</strong></td>
      <td><strong>55.94</strong></td>
      <td><strong>57.02</strong></td>
      <td><strong>56.64</strong></td>
    </tr>
    <tr>
      <td rowspan="4">Connectivity</td>
      <td>NFEs</td>
      <td>1</td>
      <td>2</td>
      <td>3</td>
      <td>4</td>
      <td>5</td>
      <td>10</td>
    </tr>
    <tr>
      <td>Vanilla</td>
      <td>86.16</td>
      <td>87.22</td>
      <td>87.22</td>
      <td>87.48</td>
      <td>87.38</td>
      <td>87.49</td>
    </tr>
    <tr>
      <td>MILD</td>
      <td>86.16</td>
      <td>88.54</td>
      <td>89.21</td>
      <td>89.75</td>
      <td>90.15</td>
      <td>90.33</td>
    </tr>
    <tr>
      <td>Ours</td>
      <td>86.16</td>
      <td><strong>91.32</strong></td>
      <td><strong>92.31</strong></td>
      <td><strong>92.82</strong></td>
      <td><strong>92.95</strong></td>
      <td><strong>93.28</strong></td>
    </tr>
  </tbody>
</table>

<div class="figure-container">
  <div class="grid-one-row">
    <div><img src="fig/ablation_reasoning.jpg" width="50%"></div>
    <div class="figure-text" style="text-align: left;">Ablation study of PIDLD under reasoning tasks. P+I+D denotes the complete model, while P+I, P+D, and P represent models with the derivative term, integral term, or both terms removed, respectively. Percentages indicate performance improvements of each ablation compared to P.</div>
  </div>
</div>


<h2>üìö Citation</h2>

<p>If you find the idea useful for your research, please consider citing</p>

<div class="citation-box">@inproceedings{chen2025pidcontrolled,
  title={{PID}-controlled Langevin Dynamics for Faster Sampling on Generative Models},
  author={Hongyi Chen and Jianhai Shu and Jingtao Ding and Yong Li and Xiao-Ping Zhang},
  booktitle={The Thirty-ninth Annual Conference on Neural Information Processing Systems},
  year={2025},
  url={https://openreview.net/forum?id=y9LHDCKeeN}
}
</div>

</body>
</html>
